<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Allometric Equations for Southern Ocean Taxa • solong</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Allometric Equations for Southern Ocean Taxa">
<meta property="og:description" content="Provides allometric equations that relate the body size of Southern Ocean taxa to body part measurements.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">solong</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SCAR/solong">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="solong" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#solong" class="anchor"></a>solong</h1></div>

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>This R package provides allometric equations that relate the body size of Southern Ocean taxa to their body part measurements. It is a component of the <a href="https://www.scar.org/data-products/southern-ocean-diet-energetics/">Southern Ocean Diet and Energetics Database</a> project.</p>
</div>
<div id="packaged-equations" class="section level2">
<h2 class="hasAnchor">
<a href="#packaged-equations" class="anchor"></a>Packaged equations</h2>
<p>The package currently includes 693 equations, covering mostly cephalopods and fish. A breakdown of the number of equations by taxonomic class and the allometric property that they estimate:</p>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png"></p>
</div>
<div id="installing" class="section level2">
<h2 class="hasAnchor">
<a href="#installing" class="anchor"></a>Installing</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(devtools)
<span class="kw">install_github</span>(<span class="st">"SCAR/solong"</span>)</code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(solong)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</code></pre></div>
<p>Let’s say we have some measurements of <em>Architeuthis dux</em> squid beaks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">LRL =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">11.3</span>, <span class="fl">13.9</span>), <span class="dt">species =</span> <span class="st">"Architeuthis dux"</span>)
x
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;     LRL species         </span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;           </span>
<span class="co">#&gt; 1  11.3 Architeuthis dux</span>
<span class="co">#&gt; 2  13.9 Architeuthis dux</span></code></pre></div>
<p>It doesn’t matter what the column names are, but we do need to set the properties of the columns so that <code>solong</code> can find the appropriate data to use in each allometric equation. Here we’ve measured lower rostral length, so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x<span class="op">$</span>LRL &lt;-<span class="st"> </span><span class="kw"><a href="reference/sol_set_property.html">sol_set_property</a></span>(x<span class="op">$</span>LRL, <span class="st">"lower rostral length"</span>)</code></pre></div>
<p>Now we can apply allometric equations to our data. What equations do we have available for our species of interest?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/sol_equation.html">sol_equations</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(taxon_name<span class="op">==</span><span class="st">"Architeuthis dux"</span>) <span class="op">%&gt;%</span><span class="st"> </span>summary
<span class="co">#&gt; equation_id: 342218_ML_Clar1986</span>
<span class="co">#&gt;   taxon_name: Architeuthis dux, taxon_aphia_id: 342218</span>
<span class="co">#&gt;   equation: function (...) tibble(allometric_value = -55.6 + 59.31 * ...)</span>
<span class="co">#&gt;   It takes as 1st input: lower rostral length (units: mm, sample range: unknown to unknown)</span>
<span class="co">#&gt;   It estimates: mantle length (units: mm)</span>
<span class="co">#&gt;   Indicator of reliability: N=11</span>
<span class="co">#&gt;   Reference: Clarke MR (1986). "A handbook for the identification of cephalopod</span>
<span class="co">#&gt; beaks. Clarendon Press, Oxford." As cited in Xavier J &amp; Cherel Y</span>
<span class="co">#&gt; (2009 updated 2016) Cephalopod beak guide for the Southern Ocean.</span>
<span class="co">#&gt; Cambridge, British Antarctic Survey, 129pp.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; equation_id: 342218_WW_Clar1986</span>
<span class="co">#&gt;   taxon_name: Architeuthis dux, taxon_aphia_id: 342218</span>
<span class="co">#&gt;   equation: function (...) tibble(allometric_value = exp(-1.773 + 4.57 * log(...)))</span>
<span class="co">#&gt;   It takes as 1st input: lower rostral length (units: mm, sample range: unknown to unknown)</span>
<span class="co">#&gt;   It estimates: wet weight (units: g)</span>
<span class="co">#&gt;   Indicator of reliability: N=9</span>
<span class="co">#&gt;   Reference: Clarke MR (1986). "A handbook for the identification of cephalopod</span>
<span class="co">#&gt; beaks. Clarendon Press, Oxford." As cited in Xavier J &amp; Cherel Y</span>
<span class="co">#&gt; (2009 updated 2016) Cephalopod beak guide for the Southern Ocean.</span>
<span class="co">#&gt; Cambridge, British Antarctic Survey, 129pp.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; equation_id: 342218_ML_Roel2000</span>
<span class="co">#&gt;   taxon_name: Architeuthis dux, taxon_aphia_id: 342218</span>
<span class="co">#&gt;   equation: function (...) tibble(allometric_value = 10^((.../11.2) + 1.723214286))</span>
<span class="co">#&gt;   It takes as 1st input: lower rostral length (units: mm, sample range: 1 to 19.5)</span>
<span class="co">#&gt;   It estimates: mantle length (units: mm)</span>
<span class="co">#&gt;   Indicator of reliability: N=43</span>
<span class="co">#&gt;   Notes: Noted by Xavier &amp; Cherel: this equation for mantle_length from LRL might be better than the Clarke (1986) one</span>
<span class="co">#&gt;   Reference: Roeleveld MAC (2000). "Giant squid beaks: implications for</span>
<span class="co">#&gt; systematics." _Journal of the Marine Biological Association of the</span>
<span class="co">#&gt; UK_, *80*, 185-187.</span></code></pre></div>
<p>Here we use the equation with ID <code>342218_ML_Roel2000</code>, which is from Roeleveld (2000) and gives the mantle length of <em>Architeuthis dux</em> based on the lower rostral length.</p>
<p>This equation can be applied to to all rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/sol_allometry.html">sol_allometry</a></span>(x, <span class="st">"342218_ML_Roel2000"</span>)
<span class="co">#&gt; # A tibble: 2 x 6</span>
<span class="co">#&gt;   LRL        species          allometric_value allometric_value_lower</span>
<span class="co">#&gt;   &lt;sl_prprt&gt; &lt;chr&gt;            &lt;sl_prprt&gt;       &lt;sl_prprt&gt;            </span>
<span class="co">#&gt; 1 11.3 [mm]  Architeuthis dux 539.6881 [mm]    NA [mm]               </span>
<span class="co">#&gt; 2 13.9 [mm]  Architeuthis dux 921.0553 [mm]    NA [mm]               </span>
<span class="co">#&gt;   allometric_value_upper allometric_property</span>
<span class="co">#&gt;   &lt;sl_prprt&gt;             &lt;chr&gt;              </span>
<span class="co">#&gt; 1 NA [mm]                mantle length      </span>
<span class="co">#&gt; 2 NA [mm]                mantle length</span></code></pre></div>
<p>Or we can apply a different equation to each row. Here we could use different allometric equations for mantle length:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xa &lt;-<span class="st"> </span><span class="kw"><a href="reference/sol_allometry.html">sol_allometry</a></span>(x, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"342218_ML_Roel2000"</span>, <span class="st">"342218_ML_Clar1986"</span>))
xa
<span class="co">#&gt; # A tibble: 2 x 6</span>
<span class="co">#&gt;   LRL        species          allometric_value allometric_value_lower</span>
<span class="co">#&gt;   &lt;sl_prprt&gt; &lt;chr&gt;            &lt;sl_prprt&gt;       &lt;sl_prprt&gt;            </span>
<span class="co">#&gt; 1 11.3 [mm]  Architeuthis dux 539.6881 [mm]    NA [mm]               </span>
<span class="co">#&gt; 2 13.9 [mm]  Architeuthis dux 768.8090 [mm]    NA [mm]               </span>
<span class="co">#&gt;   allometric_value_upper allometric_property</span>
<span class="co">#&gt;   &lt;sl_prprt&gt;             &lt;chr&gt;              </span>
<span class="co">#&gt; 1 NA [mm]                mantle length      </span>
<span class="co">#&gt; 2 NA [mm]                mantle length</span></code></pre></div>
<p>The <code>allometric_value</code> column contains the values that have been estimated, and the <code>allometric_property</code> column gives the name of the property that has been estimated.</p>
<p>We can also see that the returned <code>allometric_value</code> is of that specific property, with appropriate units:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/sol_set_property.html">sol_get_property</a></span>(xa<span class="op">$</span>allometric_value)
<span class="co">#&gt; [1] "mantle length"</span>

<span class="kw"><a href="https://rdrr.io/r/base/difftime.html">units</a></span>(xa<span class="op">$</span>allometric_value)
<span class="co">#&gt; $numerator</span>
<span class="co">#&gt; [1] "mm"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $denominator</span>
<span class="co">#&gt; character(0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "symbolic_units"</span></code></pre></div>
</div>
<div id="details" class="section level2">
<h2 class="hasAnchor">
<a href="#details" class="anchor"></a>Details</h2>
<p>We can apply equations that use different inputs, provided that they estimate the same output property. For example, equation <code>342218_WW_Clar1986</code> estimates the body weight of the squid <em>Architeuthis dux</em> based on lower rostral length measurements:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/sol_equation.html">sol_equation</a></span>(<span class="st">"342218_WW_Clar1986"</span>) <span class="op">%&gt;%</span><span class="st"> </span>summary
<span class="co">#&gt; equation_id: 342218_WW_Clar1986</span>
<span class="co">#&gt;   taxon_name: Architeuthis dux, taxon_aphia_id: 342218</span>
<span class="co">#&gt;   equation: function (...) tibble(allometric_value = exp(-1.773 + 4.57 * log(...)))</span>
<span class="co">#&gt;   It takes as 1st input: lower rostral length (units: mm, sample range: unknown to unknown)</span>
<span class="co">#&gt;   It estimates: wet weight (units: g)</span>
<span class="co">#&gt;   Indicator of reliability: N=9</span>
<span class="co">#&gt;   Reference: Clarke MR (1986). "A handbook for the identification of cephalopod</span>
<span class="co">#&gt; beaks. Clarendon Press, Oxford." As cited in Xavier J &amp; Cherel Y</span>
<span class="co">#&gt; (2009 updated 2016) Cephalopod beak guide for the Southern Ocean.</span>
<span class="co">#&gt; Cambridge, British Antarctic Survey, 129pp.</span></code></pre></div>
<p>And equation <code>195932_WW_GaBu1988</code> estimates the weight of male Weddell seals based on their standard length:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/sol_equation.html">sol_equation</a></span>(<span class="st">"195932_WW_GaBu1988"</span>) <span class="op">%&gt;%</span><span class="st"> </span>summary
<span class="co">#&gt; equation_id: 195932_WW_GaBu1988</span>
<span class="co">#&gt;   taxon_name: Leptonychotes weddellii, taxon_aphia_id: 195932</span>
<span class="co">#&gt;   equation: function (...) tibble(allometric_value = 3.66 * ... - 489.3)</span>
<span class="co">#&gt;   It takes as 1st input: standard length (units: cm, sample range: 170 to 236)</span>
<span class="co">#&gt;   It estimates: wet weight (units: kg)</span>
<span class="co">#&gt;   Indicator of reliability: N=15</span>
<span class="co">#&gt;   Notes: Applies to male animals</span>
<span class="co">#&gt;   Reference: Gales NJ, Burton HR (1988). "Use of emetics and anaesthesia for</span>
<span class="co">#&gt; dietary assessment of Weddell seals." _Australian Wildlife</span>
<span class="co">#&gt; Research_, *15*, 423-433.</span></code></pre></div>
<p>Note that this equation estimates weight in kg, whereas <code>342218_WW_Clar1986</code> estimates weight in g. We can apply the two equations together to a single data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">LRL =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">11.3</span>, <span class="ot">NA_real_</span>),
            <span class="dt">species =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Architeuthis dux"</span>, <span class="st">"Leptonychotes weddellii"</span>),
            <span class="dt">SL =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="ot">NA_real_</span>, <span class="dv">175</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">LRL =</span> <span class="kw"><a href="reference/sol_set_property.html">sol_set_property</a></span>(LRL, <span class="st">"lower rostral length"</span>),
         <span class="dt">SL =</span> <span class="kw"><a href="reference/sol_set_property.html">sol_set_property</a></span>(SL, <span class="st">"standard length"</span>, <span class="st">"cm"</span>))

xa &lt;-<span class="st"> </span><span class="kw"><a href="reference/sol_allometry.html">sol_allometry</a></span>(x, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"342218_WW_Clar1986"</span>, <span class="st">"195932_WW_GaBu1988"</span>))

xa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(species, allometric_property, allometric_value)
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   species                 allometric_property allometric_value</span>
<span class="co">#&gt;   &lt;chr&gt;                   &lt;chr&gt;               &lt;sl_prprt&gt;      </span>
<span class="co">#&gt; 1 Architeuthis dux        wet weight           11029.72 [g]   </span>
<span class="co">#&gt; 2 Leptonychotes weddellii wet weight          151200.00 [g]</span></code></pre></div>
<p>The output values are of property “wet weight” and have all been provided in g (because the output column <code>allometric value</code> must have a single set of units):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/sol_set_property.html">sol_get_property</a></span>(xa<span class="op">$</span>allometric_value)
<span class="co">#&gt; [1] "wet weight"</span>

<span class="kw"><a href="https://rdrr.io/r/base/difftime.html">units</a></span>(xa<span class="op">$</span>allometric_value)
<span class="co">#&gt; $numerator</span>
<span class="co">#&gt; [1] "g"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $denominator</span>
<span class="co">#&gt; character(0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "symbolic_units"</span></code></pre></div>
<p>If we try to apply equations that estimate different properties, we will get a warning:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">LRL =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">11.3</span>, <span class="fl">13.9</span>), <span class="dt">species =</span> <span class="st">"Architeuthis dux"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">LRL =</span> <span class="kw"><a href="reference/sol_set_property.html">sol_set_property</a></span>(LRL, <span class="st">"lower rostral length"</span>))

xa &lt;-<span class="st"> </span><span class="kw"><a href="reference/sol_allometry.html">sol_allometry</a></span>(x, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"342218_ML_Roel2000"</span>, <span class="st">"342218_WW_Clar1986"</span>))

xa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(species, allometric_property, allometric_value)
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   species          allometric_property allometric_value</span>
<span class="co">#&gt;   &lt;chr&gt;            &lt;chr&gt;                          &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Architeuthis dux mantle length                   540.</span>
<span class="co">#&gt; 2 Architeuthis dux wet weight                    28417.</span></code></pre></div>
<p>And while the <code>allometric_property</code> column still says which property was estimated for each row, the property type and units of the returned <code>allometric_value</code> will not be set, because they are not consistent across the different equations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/sol_set_property.html">sol_get_property</a></span>(xa<span class="op">$</span>allometric_value)
<span class="co">#&gt; character(0)</span></code></pre></div>
<div id="missing-information" class="section level3">
<h3 class="hasAnchor">
<a href="#missing-information" class="anchor"></a>Missing information</h3>
<p>What happens if we don’t have the required information in our data to use a particular equation? The <code>234631_SL~OL_WiMc1990</code> equation is for fish length, and requires otolith length (not present in our test data).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span>(
  <span class="kw"><a href="reference/sol_allometry.html">sol_allometry</a></span>(x, <span class="st">"234631_SL~OL_WiMc1990"</span>),
  <span class="dt">error =</span> <span class="cf">function</span>(e) <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">conditionMessage</a></span>(e)
)
<span class="co">#&gt; [1] "could not find required input properties (otolith length) in data"</span></code></pre></div>
</div>
<div id="reliability-of-equations" class="section level3">
<h3 class="hasAnchor">
<a href="#reliability-of-equations" class="anchor"></a>Reliability of equations</h3>
<p>Most equations have been published with the number of samples used to fit the equation (N) and the resulting goodness-of-fit of the equation to the data (R^2). These two quantities (if provided by the original source) can be found in the <code>reliability</code> component of an equation, and can be used to help decide if a given equation is appropriate for your data.</p>
<p>Some equations, typically from more recent publications, also provide the standard errors of the coefficients (or similar information) and thereby allow the <code>allometric_value_lower</code> and <code>allometric_value_upper</code> values to be estimated (the upper and lower bounds on the estimate). These should give a more reliable indicator of the precision of the estimated quantities.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">TL =</span> <span class="dv">10</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="reference/sol_set_property.html">sol_set_property</a></span>(<span class="st">"carapace length"</span>, <span class="dt">with_units =</span> <span class="st">"mm"</span>))
<span class="kw"><a href="reference/sol_allometry.html">sol_allometry</a></span>(x, <span class="st">"369214_WW_Lake2003"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(allometric_value, allometric_value_lower, allometric_value_upper)
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   allometric_value allometric_value_lower allometric_value_upper</span>
<span class="co">#&gt;   &lt;sl_prprt&gt;       &lt;sl_prprt&gt;             &lt;sl_prprt&gt;            </span>
<span class="co">#&gt; 1 0.8919773 [g]    0.6986516 [g]          1.138799 [g]</span></code></pre></div>
<p>Attempts are made to avoid allowing an equation to extrapolate beyond its valid input data range. Some equations will explicitly return <code>NA</code> results for such inputs. The <code>inputs</code> component of the equation may also hold information about the range of the inputs used to fit the equation, which may help assess whether your data lie within its valid range.</p>
</div>
<div id="other-sources-of-equations" class="section level3">
<h3 class="hasAnchor">
<a href="#other-sources-of-equations" class="anchor"></a>Other sources of equations</h3>
<p><a href="http://www.fishbase.org" class="uri">http://www.fishbase.org</a> provides estimates of length-weight coefficients. These can be obtained via the <code><a href="reference/sol_fb_length_weight.html">sol_fb_length_weight()</a></code> function (which uses the <code>rfishbase</code> package under the hood). For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myeq &lt;-<span class="st"> </span><span class="kw"><a href="reference/sol_fb_length_weight.html">sol_fb_length_weight</a></span>(<span class="st">"Electrona antarctica"</span>)
myeq &lt;-<span class="st"> </span>myeq[<span class="dv">2</span>, ] ## use the second one of the two that are returned
<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(myeq)
<span class="co">#&gt; equation_id: fishbase::11437</span>
<span class="co">#&gt;   taxon_name: Electrona antarctica, taxon_aphia_id: 217697</span>
<span class="co">#&gt;   equation: function (L) tibble(allometric_value = 0.00742 * (L^3.27))</span>
<span class="co">#&gt;   It takes as 1st input: standard length (units: cm, sample range: unknown to unknown)</span>
<span class="co">#&gt;   It estimates: wet weight (units: g)</span>
<span class="co">#&gt;   Indicator of reliability: R^2=0.957</span>
<span class="co">#&gt;   Reference: (????). Fishbase reference 91449 : NA . NA.</span>

x &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">SL =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">mutate</span>(<span class="dt">SL =</span> <span class="kw"><a href="reference/sol_set_property.html">sol_set_property</a></span>(SL, <span class="st">"standard length"</span>, <span class="dt">with_units =</span> <span class="st">"cm"</span>))
<span class="kw"><a href="reference/sol_allometry.html">sol_allometry</a></span>(x, myeq)
<span class="co">#&gt; # A tibble: 1 x 5</span>
<span class="co">#&gt;   SL         allometric_value allometric_value_lower allometric_value_upper</span>
<span class="co">#&gt;   &lt;sl_prprt&gt; &lt;sl_prprt&gt;       &lt;sl_prprt&gt;             &lt;sl_prprt&gt;            </span>
<span class="co">#&gt; 1 10 [cm]    13.81669 [g]     NA [g]                 NA [g]                </span>
<span class="co">#&gt;   allometric_property</span>
<span class="co">#&gt;   &lt;chr&gt;              </span>
<span class="co">#&gt; 1 wet weight</span></code></pre></div>
</div>
<div id="adding-your-own-equations" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-your-own-equations" class="anchor"></a>Adding your own equations</h3>
<p>TODO: document, including what to do when a property is not part of the <code><a href="reference/sol_properties.html">sol_properties()</a></code> collection.</p>
</div>
<div id="taxonomy" class="section level3">
<h3 class="hasAnchor">
<a href="#taxonomy" class="anchor"></a>Taxonomy</h3>
<p>Equations are registered against <em>taxon_name</em> and <em>taxon_aphia_id</em> (the species identifier in the World Register of Marine Species). The <em>taxon_aphia_id</em> may be more reliable than species names, which can change over time. Users might like to look at the <a href="https://cran.r-project.org/package=worrms">worrms package</a> for interacting with the World Register of Marine Species.</p>
</div>
<div id="other-random-stuff" class="section level3">
<h3 class="hasAnchor">
<a href="#other-random-stuff" class="anchor"></a>Other random stuff</h3>
<p>Is equation X included in the package? Call <code><a href="reference/sol_equation.html">sol_equations()</a></code> to get all equations that are part of the package, and have a rummage through that.</p>
<p>To see the references from which equations have been drawn, do something like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eqs &lt;-<span class="st"> </span><span class="kw"><a href="reference/sol_equation.html">sol_equations</a></span>()
## the first few
<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(eqs<span class="op">$</span>reference))
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Clarke MR (1986). "A handbook for the identification of cephalopod</span>
<span class="co">#&gt; beaks. Clarendon Press, Oxford." As cited in Xavier J &amp; Cherel Y</span>
<span class="co">#&gt; (2009 updated 2016) Cephalopod beak guide for the Southern Ocean.</span>
<span class="co">#&gt; Cambridge, British Antarctic Survey, 129pp.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; Roeleveld MAC (2000). "Giant squid beaks: implications for</span>
<span class="co">#&gt; systematics." _Journal of the Marine Biological Association of the</span>
<span class="co">#&gt; UK_, *80*, 185-187.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; Lu CC, Williams R (1994). "Contribution to the biology of squid in</span>
<span class="co">#&gt; the Prydz Bay region, Antarctica." _Antarctic Science_, *6*,</span>
<span class="co">#&gt; 223-229. doi: 10.1017/S0954102094000349 (URL:</span>
<span class="co">#&gt; http://doi.org/10.1017/S0954102094000349).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; Rodhouse PG, Prince PA, Clarke MR, Murray AWA (1990). "Cephalopod</span>
<span class="co">#&gt; prey of the grey-headed albatross Diomedea chrysostoma." _Marine</span>
<span class="co">#&gt; Biology_, *104*, 353-362. doi: 10.1007/BF01314337 (URL:</span>
<span class="co">#&gt; http://doi.org/10.1007/BF01314337), As cited in Xavier J &amp; Cherel</span>
<span class="co">#&gt; Y (2009 updated 2016) Cephalopod beak guide for the Southern</span>
<span class="co">#&gt; Ocean. Cambridge, British Antarctic Survey, 129pp.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; Clarke M (1962). "The identification of cephalopod "beaks" and the</span>
<span class="co">#&gt; relationship between beak size and total body weight." _Bulletin</span>
<span class="co">#&gt; of the British Museum of Natural History B_, *8*, 421-480. As</span>
<span class="co">#&gt; cited in Xavier J &amp; Cherel Y (2009 updated 2016) Cephalopod beak</span>
<span class="co">#&gt; guide for the Southern Ocean. Cambridge, British Antarctic Survey,</span>
<span class="co">#&gt; 129pp.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt; Lu CC, Ickeringill R (2002). "Cephalopod beak identification and</span>
<span class="co">#&gt; biomass estimation techniques: tools for dietary studies of</span>
<span class="co">#&gt; southern Australian finfishes." _Museum Victoria Science Reports_,</span>
<span class="co">#&gt; *6*, 1-65.</span></code></pre></div>
</div>
</div>
<div id="more-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#more-examples" class="anchor"></a>More examples</h2>
<p>Grab all equations from Eastman (2019):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eq &lt;-<span class="st"> </span><span class="kw"><a href="reference/sol_equation.html">sol_equations</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"East2019"</span>, equation_id)) <span class="op">%&gt;%</span>
<span class="st">    </span>## some equations have been included twice with different species names - drop the duplicates
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"Accepted taxon name"</span>, notes))</code></pre></div>
<p>Reproduce Figure 2 from that paper:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## extract each maximum length
max_lengths &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(eq<span class="op">$</span>equation, <span class="cf">function</span>(z) <span class="kw">z</span>()<span class="op">$</span>allometric_value)
## histogram
<span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(max_lengths, <span class="dv">20</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-24-1.png"></p>
</div>
<div id="related-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#related-packages" class="anchor"></a>Related packages</h2>
<ul>
<li>
<a href="https://cran.r-project.org/package=units">units</a> for handling units of measurement</li>
<li>
<a href="https://cran.r-project.org/package=worrms">worrms</a> for taxonomy</li>
<li>
<a href="https://cran.r-project.org/package=shapeR">shapeR</a> for collection and analysis of otolith shape data</li>
<li>
<a href="https://github.com/James-Thorson/FishLife" class="uri">https://github.com/James-Thorson/FishLife</a> for estimating fish life history parameters</li>
<li>
<a href="https://cran.r-project.org/package=rfishbase">rfishbase</a> an interface to www.fishbase.org</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/SCAR/solong">https://​github.com/​SCAR/​solong</a>
</li>
<li>Report a bug at <br><a href="https://github.com/SCAR/solong/issues">https://​github.com/​SCAR/​solong/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Ben Raymond <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/SCAR/solong"><img src="https://travis-ci.org/SCAR/solong.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/SCAR/solong"><img src="https://ci.appveyor.com/api/projects/status/github/SCAR/solong?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/gh/SCAR/solong"><img src="https://codecov.io/gh/SCAR/solong/branch/master/graph/badge.svg" alt="codecov"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Ben Raymond.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
